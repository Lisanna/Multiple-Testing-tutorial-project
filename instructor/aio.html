<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Multiple Testing: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="manifest" href="../site.webmanifest">
<link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav incubator"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Carpentries Incubator" src="../assets/images/incubator-logo.svg"><abbr class="badge badge-light" title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught." style="background-color: #FF4955; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link" style="color: #000">
            <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
            Pre-Alpha
          </a>
          <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="../assets/images/incubator-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Multiple Testing
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Multiple Testing
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<hr>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a class="btn btn-primary" href="../aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Multiple Testing
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="What%20is%20multiple%20testing.html">1. What is multiple testing</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="Types%20of%20errors.html">2. Types of errors</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="Family-wise%20error%20rate.html">3. Family-wise error rate</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr>
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="../instructor/aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-What is multiple testing"><p>Content from <a href="What%20is%20multiple%20testing.html">What is multiple testing</a></p>
<hr>
<p>Last updated on 2024-05-06 |
        
        <a href="https://example.com/FIXME-template-source/edit/main/episodes/What%20is%20multiple%20testing.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is multiple testing?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Define multiple testing</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="what-is-multiple-testing">What is multiple testing<a class="anchor" aria-label="anchor" href="#what-is-multiple-testing"></a>
</h1>
<p>Suppose the prevalence of a disease in the general population is 4%.
In this population, lives a group of individuals who have all been
exposed to air pollution. Concerned about their health, we decide to
embark on a quest to uncover whether being exposed to air pollution
influenced the risk of contracting this disease.</p>
<figure><img src="../fig/01-Disease-prevalence.png" alt="Figure_1: Disease Prevalence in a population- Illustrating the Proportion of Individuals Affected by the disease as 4% of the Population" class="figure mx-auto d-block"><div class="figcaption">Figure_1: Disease Prevalence in a population-
Illustrating the Proportion of Individuals Affected by the disease as 4%
of the Population</div>
</figure><div class="section level2">
<h2 id="setting-the-null-and-alternative-hypothesis">Setting the null and alternative hypothesis<a class="anchor" aria-label="anchor" href="#setting-the-null-and-alternative-hypothesis"></a>
</h2>
<p>We would like to conduct a hypothesis test to find out whether the
prevalence in the test group differs from the known 4%.</p>
<div class="section level3">
<h3 id="null-hypothesis-h">Null Hypothesis (H)<a class="anchor" aria-label="anchor" href="#null-hypothesis-h"></a>
</h3>
<p>The prevalence of the disease within test group exposed to air
pollution is the same as the known prevalence in the general population
(4%). This means that the proportion of individuals exposed to air
pollution in the test group who have the disease is also 4%.</p>
</div>
<div class="section level3">
<h3 id="alternative-hypothesis-h₁">Alternative Hypothesis (H₁)<a class="anchor" aria-label="anchor" href="#alternative-hypothesis-h%E2%82%81"></a>
</h3>
<p>The prevalence of the disease within the test group exposed to air
pollution is different from the known prevalence in the general
population. This suggests that the proportion of individuals exposed to
air pollution in the test group who have the disease is either
significantly higher or lower than 4%.</p>
</div>
</div>
<div class="section level2">
<h2 id="data-collection-and-testing">Data collection and testing<a class="anchor" aria-label="anchor" href="#data-collection-and-testing"></a>
</h2>
<p>We assemble a group of 100 individuals who have been exposed to air
pollution (test group) from the population and each individual is
carefully examined, checking for any signs of the disease. Out of the
100 individuals, we discover that 9 of them were indeed suffering from
the disease. But we are not satisfied with just this knowledge. We want
to know if this prevalence of the disease within the group exposed to
air pollution was significantly different from the population’s average,
which is 4. So, we decide to perform binomial test (please refer back to
binomial tests tutorial) <a href="%22https://sarahkaspar.github.io/biostatistics-course/03-binomial.html%22" class="external-link">The
binomial distribution</a>. With this test, we could compare the observed
prevalence within our group that has been exposed to air pollution to
the known prevalence in the entire population.</p>
<p>We set our significance level (α) beforehand, typically at 0.05, to
determine whether the results are statistically significant.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#For known parameters (n=100, p=0.04), we calculates the the chances of getting the 9 individuals that indeed suffered from the disease. </span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fl">100</span> <span class="co"># number of test persons</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fl">0.04</span> <span class="co"># Known prevalence of the disease in the general population</span></span>
<span><span class="fu">dbinom</span><span class="op">(</span>x<span class="op">=</span><span class="fl">9</span>, size<span class="op">=</span><span class="va">n</span>, prob<span class="op">=</span><span class="va">p</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] 0.01214746</code></pre>
</div>
<p>The P-value we get, is the probability of obtaining extreme outcome,
assuming that the null hypothesis is true. Therefore, the binomial test
calculates the probability of observing the obtained (9 persons with a
disease) or more extreme results assuming the null hypothesis is true.
If this probability is sufficiently low (below our chosen significance
level), we reject the null hypothesis in favor of the alternative
hypothesis.</p>
<p>The binomial test result (~0.012) reveals that the prevalence of the
disease among the individuals exposed to air pollution was indeed
significantly different from that of the population.</p>
</div>
</div>
<div class="section level1">
<h1 id="what-if-we-did-many-similar-experiments">What if we did many similar experiments?<a class="anchor" aria-label="anchor" href="#what-if-we-did-many-similar-experiments"></a>
</h1>
<p>Conducting a single study might not provide conclusive evidence due
to various factors such as sample variability, random chance, and other
unknown influences.</p>
<p>We decide to investigate the potential impact of air pollution on
disease prevalence in 200 various locations. We want to assess whether
there is a significant difference in disease rates between groups
exposed to air pollution and the average for the whole population.</p>
<p>We want to know how hypothesis testing works, when we perform it
simultaneously or in quick succession on many tests, each with its own
significance level (chance of producing a false positive result).</p>
<p>We therefore decide to simulate the scenario where we conduct 200
tests, each with a 5% chance (alpha = 0.05) of producing a significant
result (i.e., a p-value less than 0.05) even when the null hypothesis is
true.</p>
<p>Our null hypothesis is that there is no real difference in disease
rates between the groups exposed to air pollution and the average for
the whole population.</p>
<figure><img src="../fig/Scenario_100%20individuals%20get%20tested%20for%20a%20disease.%20The%20disease%20prevalence%20is%200.04.%20The%20experiment%20is%20repeated%20200%20times.png" alt="Figure_2: Scenario - 100 individuals get tested for a disease. The disease prevalence is 0.04. The experiment is repeated 200 times" class="figure mx-auto d-block"><div class="figcaption">Figure_2: Scenario - 100 individuals get tested
for a disease. The disease prevalence is 0.04. The experiment is
repeated 200 times</div>
</figure><p>To do this, we write a program in r, which would give us the
simulated results when the prevalence in the test group is 4% (null
hypothesis is true). We run these experiments to see what would happen
if we kept doing tests even when there was not actually any
difference.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#H0 is true: disease prevalence = 4%</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">33</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate simulated data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">table</span><span class="op">(</span><span class="fu">rbinom</span><span class="op">(</span>n<span class="op">=</span><span class="fl">200</span>, size<span class="op">=</span><span class="fl">100</span>, prob<span class="op">=</span><span class="fl">0.04</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">data.frame</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>number <span class="op">=</span> <span class="fu">as.numeric</span><span class="op">(</span><span class="fu">as.character</span><span class="op">(</span><span class="va">Var1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>significant <span class="op">=</span> <span class="fu">ifelse</span><span class="op">(</span><span class="va">number</span> <span class="op">&lt;</span> <span class="fu">qbinom</span><span class="op">(</span><span class="fl">0.025</span>, size<span class="op">=</span><span class="fl">100</span>, prob<span class="op">=</span><span class="fl">0.04</span><span class="op">)</span> <span class="op">|</span> <span class="va">number</span> <span class="op">&gt;</span> <span class="fu">qbinom</span><span class="op">(</span><span class="fl">0.975</span>, size<span class="op">=</span><span class="fl">100</span>, prob<span class="op">=</span><span class="fl">0.04</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the data</span></span>
<span><span class="va">Figure_3</span><span class="op">=</span><span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">Var1</span>, <span class="va">Freq</span>, fill <span class="op">=</span> <span class="fu">factor</span><span class="op">(</span><span class="va">significant</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_bw</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Number of patients with disease"</span>, y <span class="op">=</span> <span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"0"</span> <span class="op">=</span> <span class="st">"blue"</span>, <span class="st">"1"</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>,</span>
<span>                    labels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Not significant"</span>, <span class="st">"Significant"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Figure_3</span></span></code></pre>
</div>
<figure><img src="../fig/What%20is%20multiple%20testing-rendered-Simulating%20200%20test%20groups-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>We are interested in determining if the observed proportion
significantly deviates from the expected proportion (0.4) in either
direction (either higher or lower). As this is a two-tailed binomial
test, we needed to adjust the bounds for what is considered
“significant” based on the significance level of 0.05. We are interested
in the extreme tails of the distribution that contain 2.5% of the data
on each side.</p>
<p>We therefore use <strong>qbinom()</strong> function in this
simulation to calculate the quantiles of the binomial distribution
corresponding to the 2.5th and 97.5th percentiles. This gives us the
bounds that would contain 95% of the data under the null hypothesis. We
then classify a group as “significant” if the observed number of
patients falls below the 2.5th percentile or above the 97.5th percentile
of the binomial distribution.</p>
<p>It is important to note that the significance level (α) that we
choose for each individual test directly impacts the rate of false
positives. In out example, we have set α=0.05 for each individual test,
which means we are essentially saying that we are willing to accept a 5%
chance of making a false positive error for each test.</p>
<p>To our astonishment in <strong>Figure_3</strong>, we find that even
in a world where there was no true difference in disease prevalence,
about 5% of our simulated experiments yielded statistically significant
results purely by chance (the red bars).</p>
<p>By running this simulation multiple times, we can observe how often
we get false positive results when there should be none. This helps us
understand the likelihood of obtaining a significant result purely by
chance, even if there is no true effect or difference.</p>
<div class="section level3">
<h3 id="keyspoints">Keyspoints<a class="anchor" aria-label="anchor" href="#keyspoints"></a>
</h3>
<ul>
<li>Through this exercise, we learn a valuable lesson about the dangers
of multiple testing.</li>
<li>We realize that without proper adjustments, the likelihood of
encountering false positives (rejecting a true null hypothesis) increase
with each additional comparison.</li>
<li>We need some additional control to make sure we found more hits than
expected by chance.</li>
</ul>
</div>
<div class="section level2">
<h2 id="so-what-is-multiple-testing">So what is multiple testing?<a class="anchor" aria-label="anchor" href="#so-what-is-multiple-testing"></a>
</h2>
<p>Multiple testing refers to the practice of conducting numerous
hypothesis tests simultaneously or repeatedly on the same data set. It
is typically motivated by the desire to explore different aspects of the
data or to investigate multiple hypotheses. Researchers employ multiple
tests to examine various relationships, comparisons, or associations
within their dataset, such as comparing means, proportions,
correlations, or other statistical analyses that involve hypothesis
testing.</p>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Instructor Note</h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" data-bs-parent="#accordionInstructor1" aria-labelledby="headingInstructor1">
<div class="accordion-body">
<p>Inline instructor notes can help inform instructors of timing
challenges associated with the lessons. They appear in the “Instructor
View”</p>
</div>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div>
</div></section><section id="aio-Types of errors"><p>Content from <a href="Types%20of%20errors.html">Types of errors</a></p>
<hr>
<p>Last updated on 2024-05-06 |
        
        <a href="https://example.com/FIXME-template-source/edit/main/episodes/Types%20of%20errors.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are false positives and false negatives and how do they
manifest in a confusion matrix?</li>
<li>What are some of real examples where false positives and false
negatives have different implications and consequences?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the concept of false positives and false negatives and
how they are represented in a confusion matrix</li>
<li>Analyse and discuss scnarios where false positives and false
negatives pose distinct challenges and implications</li>
<li>Highlight situations where minimizing each type of error is
crucial</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="types-of-errors">Types of errors<a class="anchor" aria-label="anchor" href="#types-of-errors"></a>
</h1>
<p>In hypothesis testing, the evaluation of statistical significance
involves making decisions based on sample data. However, these decisions
are not without errors. In this tutorial, we will explore the concept of
errors in hypothesis testing, focusing on Type I and Type II errors, and
their implications.</p>
<div class="section level2">
<h2 id="type-i-error">Type I Error<a class="anchor" aria-label="anchor" href="#type-i-error"></a>
</h2>
<p>Type I error occurs when we reject a null hypothesis that is actually
true. For example, in our previous example where we conducted many
similar experiments, we experienced type I error by concluding that
exposure to air pollution has an effect on disease prevalence (rejecting
the null hypothesis) when it actually has no effect. Type I errors
represent false positives and can lead to incorrect conclusions,
potentially resulting in wasted resources or misguided decisions.</p>
</div>
<div class="section level2">
<h2 id="type-ii-error">Type II Error<a class="anchor" aria-label="anchor" href="#type-ii-error"></a>
</h2>
<p>Type II error occurs when we fail to reject a null hypothesis that is
actually false. For example, when we fail to conclude that exposure to
air pollution has an effect on disease prevalence (failing to reject the
null hypothesis) when it actually has a positive effect. Type II errors
represent false negatives and can result in missed opportunities or
overlooking significant effects.</p>
<p>One common way when this error occurs in the context of hypothesis
testing, is when a method with low <strong>statistical power</strong> is
chosen (if the sample size is small or the effect size (difference in
disease prevalence) is small). Statistical power refers to the
probability of correctly rejecting the null hypothesis when it is indeed
false. In simpler terms, it measures the likelihood of detecting a true
effect or difference if it exists. A test with high power is more likely
to detect a real effect, while a test with low power is more likely to
miss detecting a real effect, leading to a Type II error (false
negative).</p>
</div>
</div>
<div class="section level1">
<h1 id="confusion-matrix">Confusion Matrix<a class="anchor" aria-label="anchor" href="#confusion-matrix"></a>
</h1>
<p>In the context of hypothesis testing, we can conceptualize Type I and
Type II errors using a confusion matrix. The confusion matrix represents
the outcomes of hypothesis testing as True Positives (correctly
rejecting H0), False Positives (incorrectly rejecting H0), True
Negatives (correctly failing to reject H0), and False Negatives
(incorrectly failing to reject H0).</p>
<figure><img src="../fig/Figure%201%20Errors%20in%20hypothesis%20testing.png" alt="Figure_4: Errors in hypothesis testing and how they arise" class="figure mx-auto d-block"><div class="figcaption">Figure_4: Errors in hypothesis testing and how
they arise</div>
</figure>
</div>
<div class="section level1">
<h1 id="the-problem">The problem<a class="anchor" aria-label="anchor" href="#the-problem"></a>
</h1>
<p>In hypothesis testing, the occurrence of Type I and Type II errors
can have different implications depending on the context of the problem
being addressed. It is crucial to understand which errors are
problematic in which situation to be able to make informed decisions and
draw accurate conclusions from statistical analyses.</p>
<p>Type I errors, are particularly problematic in situations where the
cost or consequences of incorrectly rejecting a true null hypothesis are
high. Again if we refer back to our example, if we incorrectly conclude
that there is a significant difference in disease rates between the test
groups exposed to air pollution and the average for the whole population
when, in fact, there is no such difference, it could lead to misguided
policies or interventions targeting air pollution reduction. For
instance, authorities might implement costly environmental regulations
or public health measures based on erroneous conclusions. In this case,
the <strong>consequences</strong> include misallocation of resources,
leading to unnecessary financial burdens or societal disruptions.
Moreover, public trust in scientific findings and policy decisions may
be eroded if false positives lead to ineffective or burdensome
interventions.</p>
<p>Type II errors, are problematic when failing to detect a significant
effect has substantial consequences.If we fail to detect a significant
difference in disease rates between the test group and the population
average when there actually is a difference due to air pollution
exposure, it could result in overlooking a serious public health
concern. In this case, individuals living in polluted areas may continue
to suffer adverse health effects without receiving appropriate attention
or interventions. The <strong>consequences</strong> include increased
morbidity and mortality rates among populations exposed to high levels
of air pollution. Additionally, delayed or inadequate response to
environmental health risks may exacerbate inequalities in health
outcomes.</p>
<div class="section level3">
<h3 id="what-do-we-learn">What do we learn?<a class="anchor" aria-label="anchor" href="#what-do-we-learn"></a>
</h3>
<p>In many real-world scenarios, there is a trade-off between Type I and
Type II errors, and the appropriate balance depends on the specific
goals and constraints of the problem. Reseachers may prioritize one over
the other based on the severity of the consequences. For example, in
cancer screenings, minimizing false negatives (Type II errors) is
typically prioritized to avoid missing potential cases of cancer, even
if it leads to an increase in false positives (Type I errors).</p>
<p>Effective evaluation of Type I and Type II errors necessitates a
comprehensive consideration of the associated costs, risks, and ethical
implications. This holistic approach enhances the validity and
reliability of research findings by ensuring that decisions regarding
hypothesis acceptance or rejection are informed not only by statistical
significance but also by the potential real-world consequences of both
false positives and false negatives. By carefully weighing these
factors, researchers can make informed decisions that minimize the
likelihood of erroneous conclusions while maximizing the practical
relevance and ethical soundness of their findings.</p>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Instructor Note</h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<p>Inline instructor notes can help inform instructors of timing
challenges associated with the lessons. They appear in the “Instructor
View”</p>
</div>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div>
</div></section><section id="aio-Family-wise error rate"><p>Content from <a href="Family-wise%20error%20rate.html">Family-wise error rate</a></p>
<hr>
<p>Last updated on 2024-05-06 |
        
        <a href="https://example.com/FIXME-template-source/edit/main/episodes/Family-wise%20error%20rate.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 12 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is the family-wise error rate (FWER), and why is it important
in multiple testing scenarios?</li>
<li>How does the Bonferroni procedure adjust p-values to control the
FWER, and what are its limitations?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand the concept of the family-wise error rate (FWER) and its
significance in multiple testing, including the implications of making
multiple comparisons without controlling for FWER.</li>
<li>Learn the Bonferroni procedure for adjusting p-values to maintain
the FWER at a specified level, and recognize when alternative methods
may be more appropriate or effective in controlling for multiple
comparisons.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section level1">
<h1 id="family-wise-error-rate-fwer">Family-wise Error Rate (FWER)<a class="anchor" aria-label="anchor" href="#family-wise-error-rate-fwer"></a>
</h1>
<p>In statistical hypothesis testing, conducting multiple tests
simultaneously increases the likelihood of making at least one
false-positive error. In this tutorial, we will explore FWER, discuss
methods for adjusting p-values to account for multiple comparisons, and
examine practical examples.</p>
<div class="section level2">
<h2 id="a-multi-hypothesis-testing-framework">A Multi-Hypothesis Testing Framework<a class="anchor" aria-label="anchor" href="#a-multi-hypothesis-testing-framework"></a>
</h2>
<p>In multiple testing scenarios, researchers often have an overarching
hypothesis that encompasses several individual hypotheses, each
examining specific aspects or relationships within the data. This
approach allows researchers to explore various facets of the research
question comprehensively.</p>
<p>Going back to our study investigating the effects of air pollution on
the prevalence of a disease, the overarching hypothesis could be
formulated as follows:</p>
<p><em>Exposure to air pollution is associated with increased prevalence
of the disease</em></p>
<p>Under this overarching hypothesis, several individual hypotheses can
be formulated to examine different aspects of the relationship between
air pollution exposure and disease prevalence. These individual
hypotheses may focus on various pollutants, different health outcomes,
or specific populations.</p>
<p>An example using three individual hypothesis:</p>
<p><em>Hypothesis 1: Exposure to particulate matter is associated with
increased disease prevalence</em></p>
<p><em>Hypothesis 2: Exposure to nitrogen dioxide is associated with
increased disease prevalence</em></p>
<p><em>Hypothesis 3: Long-term exposure to ozone (O3) is associated with
an increased prevalence of the disease</em></p>
<figure><img src="../fig/Relationship%20between%20Overall%20Hypothesis%20and%20Individual%20Hypotheses.%20Effects%20of%20Air%20Pollution%20on%20Rdisease%20prevalence.png" alt="Figure_5: Relationship between Overall Hypothesis and Individual Hypotheses: Effects of Air Pollution on Disease Prevalence”" class="figure mx-auto d-block"><div class="figcaption">Figure_5: Relationship between Overall
Hypothesis and Individual Hypotheses: Effects of Air Pollution on
Disease Prevalence”</div>
</figure><p>In this illustration, each individual hypothesis delves into a
distinct facet of the overarching research inquiry, enabling researchers
to thoroughly examine the intricate connection between air pollution
exposure and disease prevalence. By scrutinizing the impacts of various
air pollutants on the disease, this method encourages a systematic
exploration of diverse factors and aids in revealing potential
associations or patterns within the dataset.</p>
<p>Now, let us assume that after data collection, for hypothesis 1, we
find that 15 out of 100 individuals exposed to high levels of
particulate matter develop the disease, for hypothesis 2, 20 out of 100
individuals exposed to high levels of nitrogen dioxide develop the
disease and for hypothesis 3, 5 out of 100 individuals exposed to high
levels of ozone develop the disease.</p>
<p>Let us assume we conduct statistical tests for each of these
hypotheses, resulting in p-values for each test. For simplicity, let us
maintain our significance level (alpha) at 0.05 for each individual
test. We can conduct binomial tests for each hypothesis and calculate
the p-values in R.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">100</span> <span class="co"># number of test persons</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fl">0.04</span> <span class="co"># Known prevalence of the disease in the general population</span></span>
<span></span>
<span><span class="va">individuals_suffered</span> <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">15</span>, <span class="fl">20</span>, <span class="fl">5</span><span class="op">)</span> <span class="co"># number of individuals who suffered from the disease for each hypothesis</span></span>
<span></span>
<span><span class="va">p_values</span> <span class="op">=</span> <span class="fu">sapply</span><span class="op">(</span><span class="va">individuals_suffered</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p_value</span> <span class="op">=</span> <span class="fu">dbinom</span><span class="op">(</span><span class="va">x</span>, size <span class="op">=</span> <span class="va">n</span>, prob <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span>
<span>  <span class="kw">return</span><span class="op">(</span><span class="va">p_value</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="co">#Calculate the p-values for each hypothesis using the binomial probability mass function</span></span>
<span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu">length</span><span class="op">(</span><span class="va">p_values</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">cat</span><span class="op">(</span><span class="fu">sprintf</span><span class="op">(</span><span class="st">"Hypothesis %d: p = %.4f\n"</span>, <span class="va">i</span>, <span class="va">p_values</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="co"># Print the p-values for each hypothesis</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Hypothesis 1: p = 0.0000
Hypothesis 2: p = 0.0000
Hypothesis 3: p = 0.1595</code></pre>
</div>
</div>
<div class="section level2">
<h2 id="the-bonferroni-correction">The Bonferroni correction<a class="anchor" aria-label="anchor" href="#the-bonferroni-correction"></a>
</h2>
<p>Now, to calculate the probability of having any false-positive within
the set of tests (also known as familywise error rate or FWER), we can
use methods such as the Bonferroni correction. This method adjust the
significance level for each test to control for multiple testing.</p>
<p>he Bonferroni procedure adjusts the significance level for each
individual test by dividing the desired overall significance level
(alpha) by the number of tests conducted (m).</p>
<p>Bonferroni adjusted significance level (αBonf)= α/m​</p>
<p>Where:</p>
<p>α is the desired overall significance level (usually set to 0.05). m
is the number of hypothesis tests conducted.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">α</span> <span class="op">&lt;-</span> <span class="fl">0.05</span><span class="co"># Define the desired overall significance level (alpha)</span></span>
<span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">length</span><span class="op">(</span><span class="va">p_values</span><span class="op">)</span><span class="co"># Calculate the number of hypothesis tests conducted (m)</span></span>
<span></span>
<span><span class="va">αBonf</span> <span class="op">&lt;-</span> <span class="va">α</span> <span class="op">/</span> <span class="va">m</span> <span class="co"># Calculate Bonferroni adjusted significance level</span></span></code></pre>
</div>
<p>Since in our example above we have three tests (three hypotheses),
the Bonferroni corrected significance level would be:</p>
<p>alpha_bonf = 0.05/3​ ≈0.0167</p>
<div class="section level3">
<h3 id="interpretation">
<em>Interpretation</em><a class="anchor" aria-label="anchor" href="#interpretation"></a>
</h3>
<p>For each individual test, we would compare the calculated p-value to
this adjusted significance level. If the p-value is less than or equal
to 0.0167, we would reject the null hypothesis for that test.</p>
<p>Based on the Bonferroni correction, we would reject the null
hypothesis for Hypotheses 1 and 2, indicating significant associations
between particulate matter and nitrogen dioxide exposure with disease
prevalence. However, for Hypothesis 3 (ozone), we would fail to reject
the null hypothesis, suggesting no significant association with disease
prevalence at the adjusted significance level. This adjustment for
multiple testing helps control the overall probability of making at
least one false-positive error across all tests conducted.</p>
<p>Air pollution, particularly fine particulate matter and other
pollutants, can induce systemic inflammation in the body, leading to an
increase in circulating inflammatory markers like C-reactive protein
(CRP). We decide to divide the population into four groups based on
different levels of exposure to air pollution. Lets assume these groups
are as follow:</p>
<ul>
<li>Low exposure: Individuals living in rural areas with minimal
industrial activity and low traffic density.</li>
<li>Moderate exposure: Individuals living in suburban areas with some
industrial activity and moderate traffic density.</li>
<li>High exposure: Individuals living in urban areas with significant
industrial activity and high traffic density.</li>
<li>Very high exposure: Individuals living near industrial zones, major
highways, or heavily polluted urban areas.</li>
</ul>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate example data for our four groups</span></span>
<span><span class="fu">set.seed</span><span class="op">(</span><span class="fl">123</span><span class="op">)</span>  <span class="co"># for reproducibility</span></span>
<span><span class="va">Low_exposure</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">50</span>, mean <span class="op">=</span> <span class="fl">2.5</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">Moderate_exposure</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">50</span>, mean <span class="op">=</span> <span class="fl">3.0</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">High_exposure</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">50</span>, mean <span class="op">=</span> <span class="fl">3.5</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">Very_high_exposure</span> <span class="op">&lt;-</span> <span class="fu">rnorm</span><span class="op">(</span><span class="fl">50</span>, mean <span class="op">=</span> <span class="fl">4</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine data into a single data frame</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>  value <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="va">Low_exposure</span>, <span class="va">Moderate_exposure</span>, <span class="va">High_exposure</span>, <span class="va">Very_high_exposure</span><span class="op">)</span>,</span>
<span>  group <span class="op">=</span> <span class="fu">rep</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"Low_exposure"</span>,<span class="st">"Moderate_exposure"</span>,<span class="st">"High_exposure"</span>, <span class="st">"Very_high_exposure"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">group</span>, levels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Low_exposure"</span>, <span class="st">"Moderate_exposure"</span>, <span class="st">"High_exposure"</span>, <span class="st">"Very_high_exposure"</span><span class="op">)</span><span class="op">)</span><span class="co"># Reorder the levels of the 'group' factor variable</span></span>
<span></span>
<span><span class="co"># Visualize the data</span></span>
<span><span class="fu">boxplot</span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">data</span>, col <span class="op">=</span> <span class="st">"lightblue"</span>, main <span class="op">=</span> <span class="st">"Boxplot of Four Groups"</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="../fig/Family-wise%20error%20rate-rendered-unnamed-chunk-3-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>Generally, as exposure level increases from low to very high, we
might expect to see a corresponding increase in the median exposure
level.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform one-way ANOVA</span></span>
<span><span class="va">anova_result</span> <span class="op">&lt;-</span> <span class="fu">aov</span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">group</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">anova_result</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>             Df Sum Sq Mean Sq F value  Pr(&gt;F)    
group         3   60.8  20.268   5.754 0.00086 ***
Residuals   196  690.4   3.523                    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Perform Tukey post-hoc test</span></span>
<span><span class="va">tukey_result</span> <span class="op">&lt;-</span> <span class="fu">TukeyHSD</span><span class="op">(</span><span class="va">anova_result</span><span class="op">)</span></span>
<span><span class="va">tukey_result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = value ~ group, data = data)

$group
                                           diff        lwr       upr     p adj
Moderate_exposure-Low_exposure        0.7240094 -0.2486521 1.6966710 0.2193881
High_exposure-Low_exposure            0.4233920 -0.5492695 1.3960536 0.6727404
Very_high_exposure-Low_exposure       1.5088066  0.5361450 2.4814681 0.0004795
High_exposure-Moderate_exposure      -0.3006174 -1.2732790 0.6720442 0.8539510
Very_high_exposure-Moderate_exposure  0.7847971 -0.1878644 1.7574587 0.1597266
Very_high_exposure-High_exposure      1.0854145  0.1127530 2.0580761 0.0219956</code></pre>
</div>
<p>We perform a Tukey post-hoc test using <strong>TukeyHSD()</strong> to
determine which specific group means differ significantly from each
other. The results provide pairwise comparisons of group means along
with adjusted p-values to account for multiple comparisons.</p>
</div>
</div>
<div class="section level2">
<h2 id="data-snooping">Data snooping<a class="anchor" aria-label="anchor" href="#data-snooping"></a>
</h2>
<p>In the context of the above analysis, data snooping refers to the
practice of exploring the data extensively, testing multiple hypotheses,
and making comparisons until finding a statistically significant result
or an interesting pattern. This can lead to overfitting the data or
finding false positives due to chance alone.</p>
<figure><img src="../Data%20snooping.png.png" alt="Figure_6: Data snoofing." class="figure mx-auto d-block"><div class="figcaption">Figure_6: Data snoofing.</div>
</figure><p>In our example, data snooping could involve testing multiple
comparisons between exposure groups until finding one that appears to be
statistically significant or interesting. For example, one might compare
only the “Very_high_exposure” group with the other groups, ignoring
other potential comparisons. This selective comparison increases the
likelihood of finding a significant result by chance alone.</p>
<p>After observing the initial boxplot, we might want to conduct
numerous additional analyses or subgroup comparisons based on observed
patterns, without pre-specifying these comparisons. This approach can
lead to inflated Type I error rates (false positives) if corrections for
multiple testing are not applied.</p>
<p>Data snooping can influence decision-making by focusing only on
results that appear favorable or intriguing in the data. For instance,
if a particular exposure group shows a larger mean than others, a
decision might be made to focus solely on interventions or policies
targeting that group without considering the broader context or
potential confounding factors.</p>
<div id="accordionInstructor1" class="accordion instructor-note accordion-flush">
<div class="accordion-item">
<button class="accordion-button instructor-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseInstructor1" aria-expanded="false" aria-controls="collapseInstructor1">
  <h3 class="accordion-header" id="headingInstructor1">
<div class="note-square"><i aria-hidden="true" class="callout-icon" data-feather="edit-2"></i></div>Instructor Note</h3>
</button>
<div id="collapseInstructor1" class="accordion-collapse collapse" aria-labelledby="headingInstructor1" data-bs-parent="#accordionInstructor1">
<div class="accordion-body">
<p>Inline instructor notes can help inform instructors of timing
challenges associated with the lessons. They appear in the “Instructor
View”</p>
</div>
</div>
</div>
</div>
<!-- 
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use. 
 -->
</div>
</div></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://example.com/FIXME-template-source/edit/main/README.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://example.com/FIXME-template-source/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://example.com/FIXME-template-source/" class="external-link">Source</a></p>
				<p><a href="https://example.com/FIXME-template-source/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:carolyn.mukiri@embl.de">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.4" class="external-link">sandpaper (0.16.4)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.5" class="external-link">pegboard (0.7.5)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.2" class="external-link">varnish (1.0.2)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://FIXME-template-source.github.io/NA/instructor/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://FIXME-template-source.github.io/NA/instructor/aio.html",
  "identifier": "https://FIXME-template-source.github.io/NA/instructor/aio.html",
  "dateCreated": "2024-04-18",
  "dateModified": "2024-05-06",
  "datePublished": "2024-05-06"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

